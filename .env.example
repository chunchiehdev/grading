# ========================================
# Gemini API Configuration (Required for AI grading)
# ========================================

# Primary Gemini API Key (REQUIRED)
# Get your API key from: https://aistudio.google.com/app/apikey
GEMINI_API_KEY=your_gemini_api_key_here

# Gemini Model (default: gemini-2.5-flash)
GEMINI_MODEL=gemini-2.0-flash

# ========================================
# Multi-Key Rotation (Optional but Recommended)
# ========================================
# Providing all 3 API keys enables automatic rotation with:
# - 3x throughput (24 RPM vs 8 RPM single key)
# - Automatic failover when one key hits rate limit
# - Health-based key selection across distributed workers
# - Per-key cooldown management (60s throttle recovery)
#
# Requirements for rotation:
# - ALL 3 keys must be set (rotation disabled if any missing)
# - Each key should be from a different Google account
# - All keys should have same model access (gemini-2.5-flash)
#
# If rotation is NOT enabled (missing keys):
# - Falls back to SimpleGeminiService with single key
# - Throughput limited to 8-10 RPM (free tier limit)
# - No automatic failover on rate limits
#
# Get additional API keys from different Google accounts at:
# https://aistudio.google.com/app/apikey

# Secondary Gemini API Key (OPTIONAL - for rotation)
GEMINI_API_KEY2=your_second_gemini_api_key_here

# Tertiary Gemini API Key (OPTIONAL - for rotation)
GEMINI_API_KEY3=your_third_gemini_api_key_here

# ========================================
# AI SDK Grading (Feature Flag)
# ========================================
# Enable the new AI SDK-based grading system (default: false)
# Set to 'true' to use the simplified AI SDK architecture
# Set to 'false' or omit to use the legacy grading system
#
# New system benefits:
# - 40% less code (統一的 provider 介面)
# - Type-safe structured output (Zod schema 驗證)
# - Better error handling and debugging
# - Automatic Gemini → OpenAI fallback
#
# Legacy system (default) uses:
# - gemini-rotating.server.ts (multi-key rotation)
# - ai-grader.server.ts (manual fallback logic)
USE_AI_SDK_GRADING=false

# ========================================
# Agent-based Grading (AI SDK 6 Beta)
# ========================================
# Enable Agent-based multi-step grading system (default: false)
# Set to 'true' to use the new Agent architecture with tool calling
# Requires AI SDK 6 beta (already installed)
#
# Agent system features:
# - Multi-step reasoning with 6 core tools
# - Automatic confidence scoring (0-1)
# - Low-confidence human-in-the-loop review
# - Complete execution trace logging
# - Reference document search
# - Similarity checking (plagiarism detection)
#
# Performance characteristics:
# - Execution time: 10-30 seconds (vs 3-10s traditional)
# - Token usage: 5000-15000 tokens (vs 1000-3000 traditional)
# - Cost: 3-5x more expensive but much more accurate
#
# When to use Agent grading:
# - Complex assignments requiring deep analysis
# - When accuracy is more important than speed
# - When you want transparency in AI reasoning
# - For assignments with reference materials
USE_AGENT_GRADING=false

# Agent confidence threshold (default: 0.7)
# Gradings with confidence score below this will require human review
# Range: 0.0 - 1.0
# - 0.7 (default): Balanced - review ~20-30% of gradings
# - 0.8 (strict): High quality - review ~40-50% of gradings
# - 0.6 (lenient): Fast - review ~10-20% of gradings
AGENT_CONFIDENCE_THRESHOLD=0.7
      
# MCP Configuration
USE_MCP=true
MCP_FALLBACK_TO_API=true

# Legacy AI API Configuration (Optional)
OPENAI_API_KEY=
OLLAMA_API_KEY=
OLLAMA_MODEL=
OLLAMA_API_URL=
API_URL=
AUTH_KEY=

# Database Configuration
REDIS_HOST=
REDIS_PASSWORD=
POSTGRES_USER=
POSTGRES_PASSWORD=
POSTGRES_DB=
DATABASE_URL=

# Authentication
THEME_SECRET=
AUTH_SECRET=

# Google OAuth
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=

# MinIO Storage
MINIO_ENDPOINT=
MINIO_PORT=

PDF_PARSER_API_URL=
# Prisma
PRISMA_LOG_LEVEL=

